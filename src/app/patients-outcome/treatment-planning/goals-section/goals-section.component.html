<section class="card goals-card">
  <div class="goals-card-header">
    <div>
      <p class="section-eyebrow">Goals</p>
      <p class="section-helper">Define individualized outcomes to guide the rehab plan</p>
    </div>

    <div class="search-container" role="search">
      <input type="search" class="search-input" placeholder="Search goals" aria-label="Search goals"
        autocomplete="off" [(ngModel)]="searchTerm" />
      <svg xmlns="http://www.w3.org/2000/svg" class="search-icon" fill="none" viewBox="0 0 24 24"
        stroke="currentColor" aria-hidden="true">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
          d="M21 21l-4.35-4.35m0 0A7.5 7.5 0 1010.5 18a7.5 7.5 0 006.15-3.35z" />
      </svg>
    </div>

    <button type="button" (click)="addGoal.emit()" class="btn-primary goals-add-button">
      + Add goal
    </button>
  </div>

  <div class="goals-tab-group">
    <button *ngFor="let tab of tabs" type="button" (click)="onTabSelect(tab.id)" class="goal-tab"
      [ngClass]="{ 'goal-tab-active': tab.id === activeTab }">
      <span>{{ tab.label }}</span>
      <span class="goal-tab-count" [ngClass]="{ 'goal-tab-count-active': tab.id === activeTab }">
        {{ countGoals(tab.id) }}
      </span>
    </button>
  </div>

  <div class="goal-list" *ngIf="filteredGoals.length; else noGoals">
    <article *ngFor="let goal of filteredGoals; trackBy: trackGoalById" class="goal-card">
      <div class="goal-card-header">
        <div>
          <p class="goal-title">{{ goal.name }}</p>
          <p class="goal-description">{{ goal.desc }}</p>
        </div>
        <div class="goal-actions" role="group" aria-label="Goal actions">
          <button type="button" aria-label="Edit goal" (click)="editGoal.emit(goal)" class="goal-action-button">
            <fa-icon [icon]="faPenToSquare" aria-hidden="true"></fa-icon>
            <span>Edit</span>
          </button>
          <button type="button" aria-label="Delete goal" (click)="deleteGoal.emit(goal)"
            class="goal-action-button goal-action-delete">
            <fa-icon [icon]="faTrashCan" aria-hidden="true"></fa-icon>
            <span>Delete</span>
          </button>
          <button type="button" aria-label="Reactivate goal" (click)="reactivateGoal.emit(goal)"
            class="goal-action-button goal-action-reactivate">
            <fa-icon [icon]="faRotateLeft" aria-hidden="true"></fa-icon>
            <span>Reactivate</span>
          </button>
        </div>
      </div>
      <div class="goal-meta">
        <div class="goal-meta-item">
          <span class="goal-meta-label">Target date</span>
          <span class="goal-meta-value">{{ goal.tDate | date:'MMM d, y' }}</span>
        </div>
        <div class="goal-meta-item">
          <span class="goal-meta-label">Status</span>
          <span class="goal-status" [ngClass]="getStatusClass(goal.status)">
            {{ goal?.status }}
          </span>
        </div>
      </div>
    </article>
  </div>

  <ng-template #noGoals>
    <div class="goals-empty-state">
      No goals captured for this horizon yet. Add a goal to kickstart the plan.
    </div>
  </ng-template>
</section>

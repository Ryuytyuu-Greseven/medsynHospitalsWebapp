<div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
  <!-- Left Side - Medications -->
  <div class="space-y-6">
    <!-- Current Medications -->
    <div class="mb-6">
      <app-card class="hover-lift">
      <div class="flex items-center justify-between mb-4">
        <h3 class="text-lg font-bold text-gray-900">Current Medications</h3>
        <div class="flex items-center gap-2">
          <span class="text-xs text-gray-500">{{ medications.length || 0 }} active</span>
          <button (click)="openMedicationsModal()" class="text-xs text-blue-600 hover:text-blue-800 font-medium">View All</button>
        </div>
      </div>

      <!-- Empty State -->
      <div *ngIf="!medications || medications.length === 0" class="text-center py-6">
        <div class="w-10 h-10 mx-auto bg-gray-100 rounded-full flex items-center justify-center mb-2">
          <svg class="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"></path>
          </svg>
        </div>
        <p class="text-gray-500 text-sm">No active medications</p>
      </div>

      <!-- Medications Grid Layout -->
      <div *ngIf="medications && medications.length > 0" class="grid grid-cols-4 gap-4 px-4 md:px-6 xl:px-8">
        <div *ngFor="let med of medications; let i = index" class="bg-white rounded-lg border border-gray-200 p-4 hover:shadow-sm transition-all relative">
          <!-- Active Status Indicator -->
          <div *ngIf="med.status === 'active'" class="absolute top-2 right-2 w-2 h-2 bg-green-500 rounded-full"></div>

          <div class="flex flex-col items-center text-center">
            <h4 class="font-semibold text-gray-900 text-sm mb-2 truncate w-full">{{ med.name }}</h4>
            <div class="text-xs text-gray-600 space-y-1">
              <div class="font-medium">{{ med.dosage }}</div>
              <div>{{ med.frequency }}</div>
              <div class="mt-2 text-xs text-gray-500">
                <p>{{ formatDate(med.startDate) }}</p>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Show More Button -->
      <div *ngIf="medications.length > 8" class="text-center pt-3">
        <button class="text-sm text-blue-600 hover:text-blue-800 font-medium">
          Show {{ medications.length - 8 }} more medications
        </button>
      </div>
    </app-card>
    </div>

    <!-- Previous Medications -->
    <div class="mb-6">
      <app-card class="hover-lift">
      <div class="flex items-center justify-between mb-4">
        <h3 class="text-lg font-bold text-gray-900">Previous Medications</h3>
        <div class="flex items-center gap-2">
          <span class="text-xs text-gray-500">0 discontinued</span>
          <button class="text-xs text-blue-600 hover:text-blue-800 font-medium">View All</button>
        </div>
      </div>

      <div class="text-center py-6">
        <div class="w-10 h-10 mx-auto bg-gray-100 rounded-full flex items-center justify-center mb-2">
          <svg class="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
          </svg>
        </div>
        <p class="text-gray-500 text-sm">No previous medications</p>
      </div>
    </app-card>
    </div>
  </div>

  <!-- Right Side - Diet & Nutrition -->
  <div class="space-y-6">
    <!-- Current Diet -->
    <div class="mb-6">
      <app-card class="hover-lift">
      <div class="flex items-center justify-between mb-4">
        <h3 class="text-lg font-bold text-gray-900">Current Diet Plan</h3>
        <span class="text-xs text-gray-500">Active plan</span>
      </div>

      <div class="space-y-4">
        <!-- Diet Plan Card -->
        <div class="bg-green-50 rounded-lg border border-green-200 p-4">
          <div class="flex items-center gap-3 mb-3">
            <div class="w-8 h-8 rounded-full bg-green-100 flex items-center justify-center">
              <span class="text-green-600 text-sm">ðŸ¥—</span>
            </div>
            <div>
              <h4 class="font-bold text-gray-900">Diabetes Management Diet</h4>
              <p class="text-sm text-gray-600">Low-carb, high-protein plan</p>
            </div>
          </div>
          <div class="text-xs text-gray-600">
            <p>Started: Jan 15, 2024</p>
            <p>Notes: Focus on blood sugar control</p>
          </div>
        </div>
      </div>
    </app-card>
    </div>

    <!-- Nutrition & Activity -->
    <div class="mb-6">
      <app-card class="hover-lift">
        <h3 class="text-lg font-bold text-gray-900 mb-4">Daily Nutrition & Activity</h3>

        <!-- Nutrition Stats -->
        <div class="mb-6">
          <h4 class="text-md font-semibold text-gray-700 mb-3">Nutrition Intake</h4>
          <div class="grid grid-cols-4 gap-3">
            <!-- Calories -->
            <div class="text-center p-3 bg-orange-50 rounded-lg border border-orange-200">
              <div class="text-xl font-bold text-orange-600">1,850</div>
              <div class="text-xs text-orange-700 mt-1">Calories</div>
            </div>

            <!-- Protein -->
            <div class="text-center p-3 bg-blue-50 rounded-lg border border-blue-200">
              <div class="text-xl font-bold text-blue-600">85g</div>
              <div class="text-xs text-blue-700 mt-1">Protein</div>
            </div>

            <!-- Carbs -->
            <div class="text-center p-3 bg-yellow-50 rounded-lg border border-yellow-200">
              <div class="text-xl font-bold text-yellow-600">120g</div>
              <div class="text-xs text-yellow-700 mt-1">Carbs</div>
            </div>

            <!-- Fat -->
            <div class="text-center p-3 bg-purple-50 rounded-lg border border-purple-200">
              <div class="text-xl font-bold text-purple-600">65g</div>
              <div class="text-xs text-purple-700 mt-1">Fat</div>
            </div>
          </div>
        </div>

        <!-- Activity & Burning -->
        <div>
          <h4 class="text-md font-semibold text-gray-700 mb-3">Activity & Burning</h4>
          <div class="grid grid-cols-4 gap-3">
            <!-- Calories Burned -->
            <div class="text-center p-3 bg-red-50 rounded-lg border border-red-200">
              <div class="text-xl font-bold text-red-600">420</div>
              <div class="text-xs text-red-700 mt-1">Calories Burned</div>
            </div>

            <!-- Steps -->
            <div class="text-center p-3 bg-green-50 rounded-lg border border-green-200">
              <div class="text-xl font-bold text-green-600">6,250</div>
              <div class="text-xs text-green-700 mt-1">Steps</div>
            </div>

            <!-- Distance -->
            <div class="text-center p-3 bg-blue-50 rounded-lg border border-blue-200">
              <div class="text-xl font-bold text-blue-600">3.2</div>
              <div class="text-xs text-blue-700 mt-1">Miles</div>
            </div>

            <!-- Active Minutes -->
            <div class="text-center p-3 bg-purple-50 rounded-lg border border-purple-200">
              <div class="text-xl font-bold text-purple-600">45</div>
              <div class="text-xs text-purple-700 mt-1">Active Minutes</div>
            </div>
          </div>
        </div>
      </app-card>
    </div>
  </div>
</div>

<!-- Medications Modal -->
<div *ngIf="showMedicationsModal" class="fixed inset-0 z-50 overflow-y-auto" (click)="closeMedicationsModal()">
  <div class="flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0">
    <!-- Background overlay -->
    <div class="fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity"></div>

    <!-- Modal panel -->
    <div class="inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-4xl sm:w-full" (click)="$event.stopPropagation()">
      <!-- Modal Header -->
      <div class="bg-white px-6 py-4 border-b border-gray-200">
        <div class="flex items-center justify-between">
          <div class="flex items-center gap-3">
            <div class="w-8 h-8 rounded-full bg-blue-100 flex items-center justify-center">
              <svg class="w-4 h-4 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"></path>
              </svg>
            </div>
            <div>
              <h3 class="text-lg font-semibold text-gray-900">All Medications</h3>
              <p class="text-sm text-gray-500">Complete medication history and management</p>
            </div>
          </div>
          <button (click)="closeMedicationsModal()" class="text-gray-400 hover:text-gray-600 transition-colors">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
            </svg>
          </button>
        </div>

        <!-- Search and Filter Bar -->
        <div class="mt-4 flex flex-col sm:flex-row gap-4">
          <div class="flex-1">
            <div class="relative">
              <input
                type="text"
                [(ngModel)]="medicationSearchTerm"
                (input)="filterMedications()"
                placeholder="Search medications..."
                class="w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
              <svg class="absolute left-3 top-2.5 h-4 w-4 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
              </svg>
            </div>
          </div>
          <div class="flex gap-2">
            <select [(ngModel)]="selectedStatusFilter" (change)="filterMedications()" class="px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
              <option value="all">All Status</option>
              <option value="active">Active</option>
              <option value="discontinued">Discontinued</option>
              <option value="paused">Paused</option>
            </select>
            <button (click)="openAddMedicationModal()" class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2">
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
              </svg>
              Add Medication
            </button>
          </div>
        </div>
      </div>

      <!-- Modal Body -->
      <div class="bg-gray-50 px-6 py-4 max-h-96 overflow-y-auto">
        <!-- Current Medications Section -->
        <div class="mb-6">
          <h4 class="text-md font-semibold text-gray-900 mb-3 flex items-center gap-2">
            <div class="w-2 h-2 bg-green-500 rounded-full"></div>
            Current Medications ({{ getFilteredMedications('active').length }})
          </h4>
          <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div *ngFor="let med of getFilteredMedications('active')" class="bg-white rounded-lg border border-gray-200 p-4 hover:shadow-sm transition-all">
              <div class="flex items-start justify-between">
                <div class="flex-1">
                  <div class="flex items-center gap-2 mb-2">
                    <h5 class="font-semibold text-gray-900">{{ med.name }}</h5>
                    <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800">
                      Active
                    </span>
                  </div>
                  <div class="space-y-1 text-sm text-gray-600">
                    <p><span class="font-medium">Dosage:</span> {{ med.dosage }}</p>
                    <p><span class="font-medium">Frequency:</span> {{ med.frequency }}</p>
                    <p><span class="font-medium">Started:</span> {{ formatDate(med.startDate) }}</p>
                    <p *ngIf="med.prescribedBy"><span class="font-medium">Prescribed by:</span> {{ med.prescribedBy }}</p>
                    <p *ngIf="med.notes" class="text-xs text-gray-500 mt-2 p-2 bg-gray-50 rounded">
                      <span class="font-medium">Notes:</span> {{ med.notes }}
                    </p>
                  </div>
                </div>
                <div class="flex flex-col gap-1 ml-4">
                  <button (click)="editMedication(med)" class="p-1 text-blue-600 hover:text-blue-800 transition-colors" title="Edit">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
                    </svg>
                  </button>
                  <button (click)="discontinueMedication(med)" class="p-1 text-red-600 hover:text-red-800 transition-colors" title="Discontinue">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Previous/Discontinued Medications Section -->
        <div *ngIf="getFilteredMedications('discontinued').length > 0">
          <h4 class="text-md font-semibold text-gray-900 mb-3 flex items-center gap-2">
            <div class="w-2 h-2 bg-gray-400 rounded-full"></div>
            Previous Medications ({{ getFilteredMedications('discontinued').length }})
          </h4>
          <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div *ngFor="let med of getFilteredMedications('discontinued')" class="bg-white rounded-lg border border-gray-200 p-4 opacity-75">
              <div class="flex items-start justify-between">
                <div class="flex-1">
                  <div class="flex items-center gap-2 mb-2">
                    <h5 class="font-semibold text-gray-900">{{ med.name }}</h5>
                    <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-gray-100 text-gray-800">
                      Discontinued
                    </span>
                  </div>
                  <div class="space-y-1 text-sm text-gray-600">
                    <p><span class="font-medium">Dosage:</span> {{ med.dosage }}</p>
                    <p><span class="font-medium">Duration:</span> {{ formatDate(med.startDate) }} - {{ med.endDate ? formatDate(med.endDate) : 'Ongoing' }}</p>
                    <p *ngIf="med.discontinueReason" class="text-xs text-gray-500 mt-2 p-2 bg-gray-50 rounded">
                      <span class="font-medium">Reason:</span> {{ med.discontinueReason }}
                    </p>
                  </div>
                </div>
                <div class="flex flex-col gap-1 ml-4">
                  <button (click)="viewMedicationHistory(med)" class="p-1 text-gray-600 hover:text-gray-800 transition-colors" title="View History">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"></path>
                    </svg>
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Empty State -->
        <div *ngIf="getFilteredMedications('all').length === 0" class="text-center py-8">
          <div class="w-16 h-16 mx-auto bg-gray-100 rounded-full flex items-center justify-center mb-4">
            <svg class="w-8 h-8 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
            </svg>
          </div>
          <p class="text-gray-500">No medications found matching your search criteria</p>
        </div>
      </div>

      <!-- Modal Footer -->
      <div class="bg-gray-50 px-6 py-3 flex justify-between items-center border-t border-gray-200">
        <div class="text-sm text-gray-500">
          Total: {{ getAllMedications().length }} medications
        </div>
        <div class="flex gap-3">
          <button (click)="exportMedications()" class="px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors">
            Export List
          </button>
          <button (click)="closeMedicationsModal()" class="px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors">
            Close
          </button>
        </div>
      </div>
    </div>
  </div>
</div>

